# Security Checklist
- **Auth/session**
  - ✅ Login/Register set HttpOnly cookies with `authCookieOptions` (`src/app/api/auth/login/route.ts`, `src/app/api/auth/register/route.ts`).
  - ⚠️ `/api/auth/me` relies on cookie token parsing; no CSRF needed (GET) but no rate limit; acceptable for read-only.
- **RBAC/ownership**
  - ✅ Pro APIs consistently gate with `requireAuthPro` + `requireBusinessRole` (e.g., payments `src/app/api/pro/businesses/[businessId]/payments/route.ts:15-92`).
  - ✅ Resource ownership enforced via `where: { id, businessId }` on documents/invoices/projects (e.g., `documents/view` `src/app/api/pro/businesses/[businessId]/documents/[documentId]/view/route.ts:29-49`).
- **CSRF**
  - ✅ Most mutations use `assertSameOrigin` (clients, services, payments, interactions, imports).
  - ⚠️ Dev seed endpoint missing CSRF/auth (`src/app/api/dev/seed/route.ts:6-24`).
- **Rate limiting**
  - ✅ Present on auth (login/register), invites, payments, interactions, clients, personal tx create/import.
  - ⚠️ Missing on `/api/auth/me`, `/api/health`, dev seed.
- **Uploads**
  - ✅ Client document upload enforces MIME allowlist + 20MB limit and business ownership (`src/app/api/pro/businesses/[businessId]/clients/[clientId]/documents/route.ts:55-136`).
- **SSRF**
  - ✅ `/api/logo` and `/api/favicon` block private hosts, restrict content-type/size, enforce timeouts (`src/app/api/logo/route.ts:14-120`, `src/app/api/favicon/route.ts:1-85`).
- **IDOR**
  - ✅ Document view/download scope by businessId+docId (`src/app/api/pro/businesses/[businessId]/documents/[documentId]/view/route.ts:40-48`).
  - ✅ Payments, interactions, finance endpoints always include `businessId` in queries.
- **Dev/Debug**
  - ⚠️ `/api/dev/seed` exposed when `ENABLE_DEV_SEED=1` without auth/CSRF; restrict to local/dev only.
- **Secrets/env**
  - ✅ No secrets or webhook URLs found in repo; Prisma config uses env files loaded by Next.
- **Input validation**
  - ✅ Numeric IDs parsed via regex/BigInt guards; email/phone/url validation present in client PATCH (`src/app/api/pro/businesses/[businessId]/clients/[clientId]/route.ts:239-315`).
  - ⚠️ Some GETs lack schema validation (e.g., `/api/auth/me`, `/api/health`) but low risk.
